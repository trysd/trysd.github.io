(window.webpackJsonp=window.webpackJsonp||[]).push([[38],{GV60:function(e,t,r){"use strict";r.r(t),r.d(t,"amplify_s3_album",(function(){return A}));var n=r("KQm4"),a=r("o0o1"),i=r.n(a),o=r("HaE+"),c=r("1OyB"),s=r("vuIU"),l=r("bRKV"),u=r("Nt7R"),m=r("HzrR"),p=r("JIIv"),d=r("H8iN"),f=r("c82j"),y=r("/vcS"),b=r("l1VB"),h=r("Yn1A"),g="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto),v=new Uint8Array(16);function k(){if(!g)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return g(v)}var w=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function x(e){return"string"==typeof e&&w.test(e)}for(var j=[],O=0;O<256;++O)j.push((O+256).toString(16).substr(1));function I(e,t,r){var n=(e=e||{}).random||(e.rng||k)();if(n[6]=15&n[6]|64,n[8]=63&n[8]|128,t){r=r||0;for(var a=0;a<16;++a)t[r+a]=n[a];return t}return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=(j[e[t+0]]+j[e[t+1]]+j[e[t+2]]+j[e[t+3]]+"-"+j[e[t+4]]+j[e[t+5]]+"-"+j[e[t+6]]+j[e[t+7]]+"-"+j[e[t+8]]+j[e[t+9]]+"-"+j[e[t+10]]+j[e[t+11]]+j[e[t+12]]+j[e[t+13]]+j[e[t+14]]+j[e[t+15]]).toLowerCase();if(!x(r))throw TypeError("Stringified UUID is invalid");return r}(n)}var T=new u.a("S3Album"),A=function(){function e(t){var r=this;Object(c.a)(this,e),Object(l.k)(this,t),this.contentType="binary/octet-stream",this.level=d.a.Public,this.picker=!0,this.pickerText=f.a.PICKER_TEXT,this.albumItems=[],this.imgArr={},this.list=Object(o.a)(i.a.mark((function e(){var t,n,a,o,c;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=r.level,o=r.track,c=r.identityId,T.debug("Album path: "+(n=void 0===(t=r.path)?"":t)),b.a&&"function"==typeof b.a.list){e.next=4;break}throw new Error(y.n);case 4:return e.prev=4,e.next=7,b.a.list(n,{level:a,track:o,identityId:c});case 7:r.marshal(e.sent),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(4),T.warn(e.t0);case 14:case"end":return e.stop()}}),e,null,[[4,11]])}))),this.marshal=function(e){e.forEach((function(e){var t=e.key.toLowerCase().split(".")[1];h.d.has(t)&&(!e.contentType||e.contentType&&"binary/octet-stream"===e.contentType)&&(e.contentType=r.getContentType(e))}));var t=e.filter((function(e){return e.contentType&&e.contentType.startsWith("image/")})),n=r.filter?r.filter(t):t;n=r.sort?r.sort(n):n,r.albumItems=n,T.debug("album items",r.albumItems),r.constructImgArray(r.albumItems)},this.constructImgArray=function(e){e.map((function(e){r.imgArr["".concat(e.key)]=e.key}))},this.handlePick=function(){var e=Object(o.a)(i.a.mark((function e(t){var a,o,c,s,l,u,m;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.target.files[0],c=r.level,s=r.track,l=r.fileToKey,u=(void 0===(o=r.path)?"":o)+Object(h.b)(a,l),e.prev=3,e.next=6,Object(h.e)(u,a,c,s,a.type,T);case 6:e.next=12;break;case 8:throw e.prev=8,e.t0=e.catch(3),T.error(e.t0),new Error(e.t0);case 12:Object.keys(r.imgArr).includes(u)?(r.albumItems=Object(n.a)(r.albumItems),r.imgArr[u]="".concat(u,"-").concat(I())):(m=[].concat(Object(n.a)(r.albumItems),Object(n.a)(r.filter?r.filter([{key:u}]):[{key:u}])),r.albumItems=r.sort?r.sort(m):m);case 13:case"end":return e.stop()}}),e,null,[[3,8]])})));return function(t){return e.apply(this,arguments)}}()}return Object(s.a)(e,[{key:"getContentType",value:function(e){return Object(m.c)(e.key,"image/*")}},{key:"componentWillLoad",value:function(){this.list()}},{key:"render",value:function(){var e=this;return Object(l.i)("div",null,Object(l.i)("div",{class:"album-container"},Object(l.i)("div",{class:"grid-row"},this.albumItems.map((function(t){return Object(l.i)("div",{class:"grid-item",key:"key-".concat(t.key)},Object(l.i)("amplify-s3-image",{key:e.imgArr[t.key],imgKey:t.key,level:e.level,path:e.path,identityId:e.identityId,track:e.track,handleOnError:e.handleOnError,handleOnLoad:e.handleOnLoad}),Object(l.i)("span",{class:"img-overlay"}))})))),this.picker&&Object(l.i)("amplify-picker",{pickerText:p.a.get(this.pickerText),inputHandler:function(t){return e.handlePick(t)},acceptValue:"image/*"}))}}]),e}();A.style=":host{--overlay-bg-color:rgba(0, 0, 0, 0.15)}.album-container{-webkit-box-sizing:border-box;box-sizing:border-box;max-width:100%;margin:0 auto;padding:0 2rem}.grid-row{display:-ms-flexbox;display:flex;-ms-flex-wrap:wrap;flex-wrap:wrap;margin:-1rem -1rem;padding-bottom:3rem}.grid-item{position:relative;-ms-flex:1 0 22rem;flex:1 0 22rem;-ms-flex-positive:1;flex-grow:1;margin:1rem;display:-ms-flexbox;display:flex;-ms-flex-pack:center;justify-content:center}amplify-s3-image{--width:22rem;--height:20rem;border-radius:5px;-o-object-fit:cover;object-fit:cover}.img-overlay{display:none;width:100%;height:21rem;position:absolute;top:0;left:0;background-color:var(--overlay-bg-color)}.grid-item:hover .img-overlay{display:block}"}}]);