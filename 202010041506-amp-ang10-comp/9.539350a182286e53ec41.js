(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{"/vcS":function(e,t,n){"use strict";n.d(t,"a",(function(){return w})),n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return r})),n.d(t,"d",(function(){return m})),n.d(t,"e",(function(){return f})),n.d(t,"f",(function(){return d})),n.d(t,"g",(function(){return v})),n.d(t,"h",(function(){return j})),n.d(t,"i",(function(){return O})),n.d(t,"j",(function(){return S})),n.d(t,"k",(function(){return a})),n.d(t,"l",(function(){return p})),n.d(t,"m",(function(){return h})),n.d(t,"n",(function(){return b})),n.d(t,"o",(function(){return g})),n.d(t,"p",(function(){return y})),n.d(t,"q",(function(){return u})),n.d(t,"r",(function(){return x})),n.d(t,"s",(function(){return l})),n.d(t,"t",(function(){return o})),n.d(t,"u",(function(){return s})),n.d(t,"v",(function(){return i}));var i="username",r="email",o="code",a="phone",s="password",c="country-dial-code-select",u="+1",l="amplify-auth-source",d="amplify-redirected-from-hosted-ui",p="amplify-authenticator-authState",f="Phone number can not be empty",m="No Auth module found, please ensure @aws-amplify/auth is imported",b="No Storage module found, please ensure @aws-amplify/storage is imported",h="No Interactions module found, please ensure @aws-amplify/interactions is imported",v="SETUP_TOTP",g="User has not set up software token mfa",y="User has not verified software token mfa",x="SUCCESS",w="auth",O="UI Auth",j="ToastAuthError",S="AuthStateChange"},CIHk:function(e){e.exports=JSON.parse('{"a":"@aws-sdk/client-lex-runtime-service","b":"1.0.0-gamma.8"}')},OkRK:function(e,t,n){"use strict";n.r(t),n.d(t,"amplify_chatbot",(function(){return Ut}));var i,r,o,a,s,c,u,l,d,p,f,m,b,h,v,g,y,x,w,O,j,S,E,T,k,C,A,L,I,R,_,N,P,z,F,B,M,U,D,$,q,H,V,G,W,J,X,Y,K,Q,Z,ee,te,ne,ie,re,oe,ae,se,ce,ue=n("KQm4"),le=n("o0o1"),de=n.n(le),pe=n("HaE+"),fe=n("1OyB"),me=n("vuIU"),be=n("bRKV"),he=n("Nt7R"),ve=n("HzrR"),ge=n("JIIv"),ye=n("c82j"),xe=n("/vcS"),we=n("fQM2"),Oe=function(){return(Oe=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},je=new he.a("AbstractInteractionsProvider"),Se=function(){function e(e){void 0===e&&(e={}),this._config=e}return e.prototype.configure=function(e){return void 0===e&&(e={}),this._config=Oe(Oe({},this._config),e),je.debug("configure "+this.getProviderName(),this._config),this.options},e.prototype.getCategory=function(){return"Interactions"},Object.defineProperty(e.prototype,"options",{get:function(){return Oe({},this._config)},enumerable:!0,configurable:!0}),e}(),Ee=n("mrSG"),Te=n("CIHk"),ke=n("viNG"),Ce=n("LUnR"),Ae=n("J2eM"),Le=n("UMev"),Ie=n("c14h"),Re=n("S3Uu"),_e=n("N9sX"),Ne=n("wU8f"),Pe=n("XWO8"),ze="runtime.lex.{region}.amazonaws.com",Fe=new Set(["ap-east-1","ap-northeast-1","ap-northeast-2","ap-south-1","ap-southeast-1","ap-southeast-2","ca-central-1","eu-central-1","eu-north-1","eu-west-1","eu-west-2","eu-west-3","me-south-1","sa-east-1","us-east-1","us-east-2","us-west-1","us-west-2"]),Be=new Set(["cn-north-1","cn-northwest-1"]),Me=new Set(["us-iso-east-1"]),Ue=new Set(["us-isob-east-1"]),De=new Set(["us-gov-east-1","us-gov-west-1"]),$e={apiVersion:"2016-11-28",disableHostPrefix:!1,regionInfoProvider:function(e,t){var n=void 0;switch(e){case"eu-west-1":n={hostname:"runtime.lex.eu-west-1.amazonaws.com",partition:"aws",signingService:"lex"};break;case"us-east-1":n={hostname:"runtime.lex.us-east-1.amazonaws.com",partition:"aws",signingService:"lex"};break;case"us-west-2":n={hostname:"runtime.lex.us-west-2.amazonaws.com",partition:"aws",signingService:"lex"};break;default:Fe.has(e)&&(n={hostname:ze.replace("{region}",e),partition:"aws",signingService:"lex"}),Be.has(e)&&(n={hostname:"runtime.lex.{region}.amazonaws.com.cn".replace("{region}",e),partition:"aws-cn"}),Me.has(e)&&(n={hostname:"runtime.lex.{region}.c2s.ic.gov".replace("{region}",e),partition:"aws-iso"}),Ue.has(e)&&(n={hostname:"runtime.lex.{region}.sc2s.sgov.gov".replace("{region}",e),partition:"aws-iso-b"}),De.has(e)&&(n={hostname:"runtime.lex.{region}.amazonaws.com".replace("{region}",e),partition:"aws-us-gov"}),void 0===n&&(n={hostname:ze.replace("{region}",e),partition:"aws",signingService:"lex"})}return Promise.resolve(n)},signingName:"lex"},qe=Object(Ee.a)(Object(Ee.a)({},$e),{runtime:"browser",base64Decoder:Re.a,base64Encoder:Re.b,bodyLengthChecker:_e.a,credentialDefaultProvider:Object(Ae.a)("Credential is missing"),defaultUserAgent:Object(Ne.a)(Te.a,Te.b),maxAttempts:Le.a,region:Object(Ae.a)("Region is missing"),requestHandler:new Ce.a,sha256:ke.Sha256,streamCollector:Ce.b,urlParser:Ie.a,utf8Decoder:Pe.fromUtf8,utf8Encoder:Pe.toUtf8}),He=n("NtRE"),Ve=n("naxo"),Ge=n("Nl9j"),We=n("+tRG"),Je=n("qcsT"),Xe=n("87YT"),Ye=n("EI00"),Ke=function(e){function t(t){var n=this,i=Object(Ee.a)(Object(Ee.a)({},qe),t),r=Object(He.b)(i),o=Object(He.a)(r),a=Object(Je.b)(o),s=Object(Le.c)(a),c=Object(Xe.b)(s),u=Object(Ge.b)(c),l=Object(We.b)(u);return(n=e.call(this,l)||this).config=l,n.middlewareStack.use(Object(Je.a)(n.config)),n.middlewareStack.use(Object(Le.b)(n.config)),n.middlewareStack.use(Object(Xe.a)(n.config)),n.middlewareStack.use(Object(Ve.a)(n.config)),n.middlewareStack.use(Object(Ge.a)(n.config)),n.middlewareStack.use(Object(We.a)(n.config)),n}return Object(Ee.d)(t,e),t.prototype.destroy=function(){e.prototype.destroy.call(this)},t}(Ye.a);(r=i||(i={})).filterSensitiveLog=function(e){return Object(Ee.a)({},e)},r.isa=function(e){return Object(Ye.i)(e,"BadGatewayException")},(a=o||(o={})).filterSensitiveLog=function(e){return Object(Ee.a)({},e)},a.isa=function(e){return Object(Ye.i)(e,"BadRequestException")},(c=s||(s={})).filterSensitiveLog=function(e){return Object(Ee.a)({},e)},c.isa=function(e){return Object(Ye.i)(e,"Button")},function(e){e.CONFIRMED="Confirmed",e.DENIED="Denied",e.NONE="None"}(u||(u={})),(d=l||(l={})).filterSensitiveLog=function(e){return Object(Ee.a)({},e)},d.isa=function(e){return Object(Ye.i)(e,"ConflictException")},function(e){e.GENERIC="application/vnd.amazonaws.card.generic"}(p||(p={})),(m=f||(f={})).filterSensitiveLog=function(e){return Object(Ee.a)({},e)},m.isa=function(e){return Object(Ye.i)(e,"DeleteSessionRequest")},(h=b||(b={})).filterSensitiveLog=function(e){return Object(Ee.a)({},e)},h.isa=function(e){return Object(Ye.i)(e,"DeleteSessionResponse")},(g=v||(v={})).filterSensitiveLog=function(e){return Object(Ee.a)({},e)},g.isa=function(e){return Object(Ye.i)(e,"DependencyFailedException")},(x=y||(y={})).filterSensitiveLog=function(e){return Object(Ee.a)(Object(Ee.a)(Object(Ee.a)({},e),e.message&&{message:Ye.d}),e.slots&&{slots:Ye.d})},x.isa=function(e){return Object(Ye.i)(e,"DialogAction")},function(e){e.CLOSE="Close",e.CONFIRM_INTENT="ConfirmIntent",e.DELEGATE="Delegate",e.ELICIT_INTENT="ElicitIntent",e.ELICIT_SLOT="ElicitSlot"}(w||(w={})),function(e){e.CONFIRM_INTENT="ConfirmIntent",e.ELICIT_INTENT="ElicitIntent",e.ELICIT_SLOT="ElicitSlot",e.FAILED="Failed",e.FULFILLED="Fulfilled",e.READY_FOR_FULFILLMENT="ReadyForFulfillment"}(O||(O={})),function(e){e.FAILED="Failed",e.FULFILLED="Fulfilled",e.READY_FOR_FULFILLMENT="ReadyForFulfillment"}(j||(j={})),(E=S||(S={})).filterSensitiveLog=function(e){return Object(Ee.a)({},e)},E.isa=function(e){return Object(Ye.i)(e,"GenericAttachment")},(k=T||(T={})).filterSensitiveLog=function(e){return Object(Ee.a)({},e)},k.isa=function(e){return Object(Ye.i)(e,"GetSessionRequest")},(A=C||(C={})).filterSensitiveLog=function(e){return Object(Ee.a)(Object(Ee.a)(Object(Ee.a)(Object(Ee.a)({},e),e.dialogAction&&{dialogAction:y.filterSensitiveLog(e.dialogAction)}),e.recentIntentSummaryView&&{recentIntentSummaryView:e.recentIntentSummaryView.map((function(e){return L.filterSensitiveLog(e)}))}),e.sessionAttributes&&{sessionAttributes:Ye.d})},A.isa=function(e){return Object(Ye.i)(e,"GetSessionResponse")},(I=L||(L={})).filterSensitiveLog=function(e){return Object(Ee.a)(Object(Ee.a)({},e),e.slots&&{slots:Ye.d})},I.isa=function(e){return Object(Ye.i)(e,"IntentSummary")},(_=R||(R={})).filterSensitiveLog=function(e){return Object(Ee.a)({},e)},_.isa=function(e){return Object(Ye.i)(e,"InternalFailureException")},(P=N||(N={})).filterSensitiveLog=function(e){return Object(Ee.a)({},e)},P.isa=function(e){return Object(Ye.i)(e,"LimitExceededException")},(F=z||(z={})).filterSensitiveLog=function(e){return Object(Ee.a)({},e)},F.isa=function(e){return Object(Ye.i)(e,"LoopDetectedException")},function(e){e.COMPOSITE="Composite",e.CUSTOM_PAYLOAD="CustomPayload",e.PLAIN_TEXT="PlainText",e.SSML="SSML"}(B||(B={})),(U=M||(M={})).filterSensitiveLog=function(e){return Object(Ee.a)({},e)},U.isa=function(e){return Object(Ye.i)(e,"NotAcceptableException")},($=D||(D={})).filterSensitiveLog=function(e){return Object(Ee.a)({},e)},$.isa=function(e){return Object(Ye.i)(e,"NotFoundException")},(H=q||(q={})).filterSensitiveLog=function(e){return Object(Ee.a)(Object(Ee.a)(Object(Ee.a)({},e),e.sessionAttributes&&{sessionAttributes:Ye.d}),e.requestAttributes&&{requestAttributes:Ye.d})},H.isa=function(e){return Object(Ye.i)(e,"PostContentRequest")},(G=V||(V={})).filterSensitiveLog=function(e){return Object(Ee.a)(Object(Ee.a)({},e),e.message&&{message:Ye.d})},G.isa=function(e){return Object(Ye.i)(e,"PostContentResponse")},(J=W||(W={})).filterSensitiveLog=function(e){return Object(Ee.a)(Object(Ee.a)(Object(Ee.a)(Object(Ee.a)({},e),e.inputText&&{inputText:Ye.d}),e.sessionAttributes&&{sessionAttributes:Ye.d}),e.requestAttributes&&{requestAttributes:Ye.d})},J.isa=function(e){return Object(Ye.i)(e,"PostTextRequest")},(Y=X||(X={})).filterSensitiveLog=function(e){return Object(Ee.a)(Object(Ee.a)(Object(Ee.a)(Object(Ee.a)({},e),e.message&&{message:Ye.d}),e.slots&&{slots:Ye.d}),e.sessionAttributes&&{sessionAttributes:Ye.d})},Y.isa=function(e){return Object(Ye.i)(e,"PostTextResponse")},(Q=K||(K={})).filterSensitiveLog=function(e){return Object(Ee.a)(Object(Ee.a)(Object(Ee.a)(Object(Ee.a)({},e),e.dialogAction&&{dialogAction:y.filterSensitiveLog(e.dialogAction)}),e.recentIntentSummaryView&&{recentIntentSummaryView:e.recentIntentSummaryView.map((function(e){return L.filterSensitiveLog(e)}))}),e.sessionAttributes&&{sessionAttributes:Ye.d})},Q.isa=function(e){return Object(Ye.i)(e,"PutSessionRequest")},(ee=Z||(Z={})).filterSensitiveLog=function(e){return Object(Ee.a)(Object(Ee.a)({},e),e.message&&{message:Ye.d})},ee.isa=function(e){return Object(Ye.i)(e,"PutSessionResponse")},(ne=te||(te={})).filterSensitiveLog=function(e){return Object(Ee.a)({},e)},ne.isa=function(e){return Object(Ye.i)(e,"RequestTimeoutException")},(re=ie||(ie={})).filterSensitiveLog=function(e){return Object(Ee.a)({},e)},re.isa=function(e){return Object(Ye.i)(e,"ResponseCard")},(ae=oe||(oe={})).filterSensitiveLog=function(e){return Object(Ee.a)({},e)},ae.isa=function(e){return Object(Ye.i)(e,"SentimentResponse")},(ce=se||(se={})).filterSensitiveLog=function(e){return Object(Ee.a)({},e)},ce.isa=function(e){return Object(Ye.i)(e,"UnsupportedMediaTypeException")};var Qe=n("Enk7"),Ze=function(e,t){return Object(Ee.b)(void 0,void 0,void 0,(function(){var n,i,r,o,a,s,c,u,l,d,p,f,m,b,h,v,g,y;return Object(Ee.e)(this,(function(x){switch(x.label){case 0:return i=[Object(Ee.a)({},e)],y={},[4,gt(e.body,t)];case 1:switch(n=Ee.a.apply(void 0,i.concat([(y.body=x.sent(),y)])),o="UnknownError",o=yt(e,n.body)){case"BadGatewayException":case"com.amazonaws.lexruntimeservice#BadGatewayException":return[3,2];case"BadRequestException":case"com.amazonaws.lexruntimeservice#BadRequestException":return[3,4];case"ConflictException":case"com.amazonaws.lexruntimeservice#ConflictException":return[3,6];case"DependencyFailedException":case"com.amazonaws.lexruntimeservice#DependencyFailedException":return[3,8];case"InternalFailureException":case"com.amazonaws.lexruntimeservice#InternalFailureException":return[3,10];case"LimitExceededException":case"com.amazonaws.lexruntimeservice#LimitExceededException":return[3,12];case"LoopDetectedException":case"com.amazonaws.lexruntimeservice#LoopDetectedException":return[3,14];case"NotAcceptableException":case"com.amazonaws.lexruntimeservice#NotAcceptableException":return[3,16];case"NotFoundException":case"com.amazonaws.lexruntimeservice#NotFoundException":return[3,18];case"RequestTimeoutException":case"com.amazonaws.lexruntimeservice#RequestTimeoutException":return[3,20];case"UnsupportedMediaTypeException":case"com.amazonaws.lexruntimeservice#UnsupportedMediaTypeException":return[3,22]}return[3,24];case 2:return a=[{}],[4,tt(n,t)];case 3:return r=Ee.a.apply(void 0,[Ee.a.apply(void 0,a.concat([x.sent()])),{name:o,$metadata:ht(e)}]),[3,25];case 4:return s=[{}],[4,nt(n,t)];case 5:return r=Ee.a.apply(void 0,[Ee.a.apply(void 0,s.concat([x.sent()])),{name:o,$metadata:ht(e)}]),[3,25];case 6:return c=[{}],[4,it(n,t)];case 7:return r=Ee.a.apply(void 0,[Ee.a.apply(void 0,c.concat([x.sent()])),{name:o,$metadata:ht(e)}]),[3,25];case 8:return u=[{}],[4,rt(n,t)];case 9:return r=Ee.a.apply(void 0,[Ee.a.apply(void 0,u.concat([x.sent()])),{name:o,$metadata:ht(e)}]),[3,25];case 10:return l=[{}],[4,ot(n,t)];case 11:return r=Ee.a.apply(void 0,[Ee.a.apply(void 0,l.concat([x.sent()])),{name:o,$metadata:ht(e)}]),[3,25];case 12:return d=[{}],[4,at(n,t)];case 13:return r=Ee.a.apply(void 0,[Ee.a.apply(void 0,d.concat([x.sent()])),{name:o,$metadata:ht(e)}]),[3,25];case 14:return p=[{}],[4,st(n,t)];case 15:return r=Ee.a.apply(void 0,[Ee.a.apply(void 0,p.concat([x.sent()])),{name:o,$metadata:ht(e)}]),[3,25];case 16:return f=[{}],[4,ct(n,t)];case 17:return r=Ee.a.apply(void 0,[Ee.a.apply(void 0,f.concat([x.sent()])),{name:o,$metadata:ht(e)}]),[3,25];case 18:return m=[{}],[4,ut(n,t)];case 19:return r=Ee.a.apply(void 0,[Ee.a.apply(void 0,m.concat([x.sent()])),{name:o,$metadata:ht(e)}]),[3,25];case 20:return b=[{}],[4,lt(n,t)];case 21:return r=Ee.a.apply(void 0,[Ee.a.apply(void 0,b.concat([x.sent()])),{name:o,$metadata:ht(e)}]),[3,25];case 22:return h=[{}],[4,dt(n,t)];case 23:return r=Ee.a.apply(void 0,[Ee.a.apply(void 0,h.concat([x.sent()])),{name:o,$metadata:ht(e)}]),[3,25];case 24:o=(v=n.body).code||v.Code||o,r=Object(Ee.a)(Object(Ee.a)({},v),{name:""+o,message:v.message||v.Message||o,$fault:"client",$metadata:ht(e)}),x.label=25;case 25:return r.message=g=r.message||r.Message||o,delete r.Message,[2,Promise.reject(Object.assign(new Error(g),r))]}}))}))},et=function(e,t){return Object(Ee.b)(void 0,void 0,void 0,(function(){var n,i,r,o,a,s,c,u,l,d,p,f,m,b,h;return Object(Ee.e)(this,(function(v){switch(v.label){case 0:return i=[Object(Ee.a)({},e)],h={},[4,gt(e.body,t)];case 1:switch(n=Ee.a.apply(void 0,i.concat([(h.body=v.sent(),h)])),o="UnknownError",o=yt(e,n.body)){case"BadGatewayException":case"com.amazonaws.lexruntimeservice#BadGatewayException":return[3,2];case"BadRequestException":case"com.amazonaws.lexruntimeservice#BadRequestException":return[3,4];case"ConflictException":case"com.amazonaws.lexruntimeservice#ConflictException":return[3,6];case"DependencyFailedException":case"com.amazonaws.lexruntimeservice#DependencyFailedException":return[3,8];case"InternalFailureException":case"com.amazonaws.lexruntimeservice#InternalFailureException":return[3,10];case"LimitExceededException":case"com.amazonaws.lexruntimeservice#LimitExceededException":return[3,12];case"LoopDetectedException":case"com.amazonaws.lexruntimeservice#LoopDetectedException":return[3,14];case"NotFoundException":case"com.amazonaws.lexruntimeservice#NotFoundException":return[3,16]}return[3,18];case 2:return a=[{}],[4,tt(n,t)];case 3:return r=Ee.a.apply(void 0,[Ee.a.apply(void 0,a.concat([v.sent()])),{name:o,$metadata:ht(e)}]),[3,19];case 4:return s=[{}],[4,nt(n,t)];case 5:return r=Ee.a.apply(void 0,[Ee.a.apply(void 0,s.concat([v.sent()])),{name:o,$metadata:ht(e)}]),[3,19];case 6:return c=[{}],[4,it(n,t)];case 7:return r=Ee.a.apply(void 0,[Ee.a.apply(void 0,c.concat([v.sent()])),{name:o,$metadata:ht(e)}]),[3,19];case 8:return u=[{}],[4,rt(n,t)];case 9:return r=Ee.a.apply(void 0,[Ee.a.apply(void 0,u.concat([v.sent()])),{name:o,$metadata:ht(e)}]),[3,19];case 10:return l=[{}],[4,ot(n,t)];case 11:return r=Ee.a.apply(void 0,[Ee.a.apply(void 0,l.concat([v.sent()])),{name:o,$metadata:ht(e)}]),[3,19];case 12:return d=[{}],[4,at(n,t)];case 13:return r=Ee.a.apply(void 0,[Ee.a.apply(void 0,d.concat([v.sent()])),{name:o,$metadata:ht(e)}]),[3,19];case 14:return p=[{}],[4,st(n,t)];case 15:return r=Ee.a.apply(void 0,[Ee.a.apply(void 0,p.concat([v.sent()])),{name:o,$metadata:ht(e)}]),[3,19];case 16:return f=[{}],[4,ut(n,t)];case 17:return r=Ee.a.apply(void 0,[Ee.a.apply(void 0,f.concat([v.sent()])),{name:o,$metadata:ht(e)}]),[3,19];case 18:o=(m=n.body).code||m.Code||o,r=Object(Ee.a)(Object(Ee.a)({},m),{name:""+o,message:m.message||m.Message||o,$fault:"client",$metadata:ht(e)}),v.label=19;case 19:return r.message=b=r.message||r.Message||o,delete r.Message,[2,Promise.reject(Object.assign(new Error(b),r))]}}))}))},tt=function(e,t){return Object(Ee.b)(void 0,void 0,void 0,(function(){var t,n;return Object(Ee.e)(this,(function(i){return t={name:"BadGatewayException",$fault:"server",$metadata:ht(e),Message:void 0},null!=(n=e.body).Message&&(t.Message=n.Message),[2,t]}))}))},nt=function(e,t){return Object(Ee.b)(void 0,void 0,void 0,(function(){var t,n;return Object(Ee.e)(this,(function(i){return t={name:"BadRequestException",$fault:"client",$metadata:ht(e),message:void 0},null!=(n=e.body).message&&(t.message=n.message),[2,t]}))}))},it=function(e,t){return Object(Ee.b)(void 0,void 0,void 0,(function(){var t,n;return Object(Ee.e)(this,(function(i){return t={name:"ConflictException",$fault:"client",$metadata:ht(e),message:void 0},null!=(n=e.body).message&&(t.message=n.message),[2,t]}))}))},rt=function(e,t){return Object(Ee.b)(void 0,void 0,void 0,(function(){var t,n;return Object(Ee.e)(this,(function(i){return t={name:"DependencyFailedException",$fault:"client",$metadata:ht(e),Message:void 0},null!=(n=e.body).Message&&(t.Message=n.Message),[2,t]}))}))},ot=function(e,t){return Object(Ee.b)(void 0,void 0,void 0,(function(){var t,n;return Object(Ee.e)(this,(function(i){return t={name:"InternalFailureException",$fault:"server",$metadata:ht(e),message:void 0},null!=(n=e.body).message&&(t.message=n.message),[2,t]}))}))},at=function(e,t){return Object(Ee.b)(void 0,void 0,void 0,(function(){var t,n;return Object(Ee.e)(this,(function(i){return t={name:"LimitExceededException",$fault:"client",$metadata:ht(e),message:void 0,retryAfterSeconds:void 0},void 0!==e.headers["retry-after"]&&(t.retryAfterSeconds=e.headers["retry-after"]),null!=(n=e.body).message&&(t.message=n.message),[2,t]}))}))},st=function(e,t){return Object(Ee.b)(void 0,void 0,void 0,(function(){var t,n;return Object(Ee.e)(this,(function(i){return t={name:"LoopDetectedException",$fault:"server",$metadata:ht(e),Message:void 0},null!=(n=e.body).Message&&(t.Message=n.Message),[2,t]}))}))},ct=function(e,t){return Object(Ee.b)(void 0,void 0,void 0,(function(){var t,n;return Object(Ee.e)(this,(function(i){return t={name:"NotAcceptableException",$fault:"client",$metadata:ht(e),message:void 0},null!=(n=e.body).message&&(t.message=n.message),[2,t]}))}))},ut=function(e,t){return Object(Ee.b)(void 0,void 0,void 0,(function(){var t,n;return Object(Ee.e)(this,(function(i){return t={name:"NotFoundException",$fault:"client",$metadata:ht(e),message:void 0},null!=(n=e.body).message&&(t.message=n.message),[2,t]}))}))},lt=function(e,t){return Object(Ee.b)(void 0,void 0,void 0,(function(){var t,n;return Object(Ee.e)(this,(function(i){return t={name:"RequestTimeoutException",$fault:"client",$metadata:ht(e),message:void 0},null!=(n=e.body).message&&(t.message=n.message),[2,t]}))}))},dt=function(e,t){return Object(Ee.b)(void 0,void 0,void 0,(function(){var t,n;return Object(Ee.e)(this,(function(i){return t={name:"UnsupportedMediaTypeException",$fault:"client",$metadata:ht(e),message:void 0},null!=(n=e.body).message&&(t.message=n.message),[2,t]}))}))},pt=function(e,t){return Object.entries(e).reduce((function(e,t){var n,i=Object(Ee.g)(t,2),r=i[0],o=i[1];return Object(Ee.a)(Object(Ee.a)({},e),((n={})[r]=o,n))}),{})},ft=function(e,t){return(e||[]).map((function(e){return function(e,t){return{__type:"GenericAttachment",attachmentLinkUrl:null!=e.attachmentLinkUrl?e.attachmentLinkUrl:void 0,buttons:null!=e.buttons?mt(e.buttons,t):void 0,imageUrl:null!=e.imageUrl?e.imageUrl:void 0,subTitle:null!=e.subTitle?e.subTitle:void 0,title:null!=e.title?e.title:void 0}}(e,t)}))},mt=function(e,t){return(e||[]).map((function(e){return function(e,t){return{__type:"Button",text:null!=e.text?e.text:void 0,value:null!=e.value?e.value:void 0}}(e)}))},bt=function(e,t){return Object.entries(e).reduce((function(e,t){var n,i=Object(Ee.g)(t,2),r=i[0],o=i[1];return Object(Ee.a)(Object(Ee.a)({},e),((n={})[r]=o,n))}),{})},ht=function(e){return{httpStatusCode:e.statusCode,httpHeaders:e.headers,requestId:e.headers["x-amzn-requestid"]}},vt=function(e){return!(void 0===e||""===e||Object.getOwnPropertyNames(e).includes("length")&&0==e.length||Object.getOwnPropertyNames(e).includes("size")&&0==e.size)},gt=function(e,t){return function(e,t){return function(e,t){return void 0===e&&(e=new Uint8Array),e instanceof Uint8Array?Promise.resolve(e):t.streamCollector(e)||Promise.resolve(new Uint8Array)}(e,t).then((function(e){return t.utf8Encoder(e)}))}(e,t).then((function(e){return e.length?JSON.parse(e):{}}))},yt=function(e,t){var n=function(e){var t=e;return t.indexOf(":")>=0&&(t=t.split(":")[0]),t.indexOf("#")>=0&&(t=t.split("#")[1]),t},i=Object.keys(e.headers).find((function(e){return e.toLowerCase()==="x-amzn-errortype".toLowerCase()}));return void 0!==i?n(e.headers[i]):void 0!==t.code?n(t.code):void 0!==t.__type?n(t.__type):""},xt=n("mRvm"),wt=function(e){function t(t){var n=e.call(this)||this;return n.input=t,n}return Object(Ee.d)(t,e),t.prototype.resolveMiddleware=function(e,t,n){this.middlewareStack.use(Object(xt.a)(t,this.serialize,this.deserialize));var i=e.concat(this.middlewareStack),r=t.requestHandler;return i.resolve((function(e){return r.handle(e.request,n||{})}),{logger:t.logger,inputFilterSensitiveLog:W.filterSensitiveLog,outputFilterSensitiveLog:X.filterSensitiveLog})},t.prototype.serialize=function(e,t){return function(e,t){return Object(Ee.b)(void 0,void 0,void 0,(function(){var n,i,r,o,a,s;return Object(Ee.e)(this,(function(c){switch(c.label){case 0:if(n={"Content-Type":"application/json"},i="/bot/{botName}/alias/{botAlias}/user/{userId}/text",void 0===e.userId)throw new Error("No value provided for input HTTP label: userId.");if((r=e.userId).length<=0)throw new Error("Empty value provided for input HTTP label: userId.");if(i=i.replace("{userId}",Object(Ye.f)(r)),void 0===e.botName)throw new Error("No value provided for input HTTP label: botName.");if((r=e.botName).length<=0)throw new Error("Empty value provided for input HTTP label: botName.");if(i=i.replace("{botName}",Object(Ye.f)(r)),void 0===e.botAlias)throw new Error("No value provided for input HTTP label: botAlias.");if((r=e.botAlias).length<=0)throw new Error("Empty value provided for input HTTP label: botAlias.");return i=i.replace("{botAlias}",Object(Ye.f)(r)),o=JSON.stringify(Object(Ee.a)(Object(Ee.a)(Object(Ee.a)({},void 0!==e.inputText&&{inputText:e.inputText}),void 0!==e.requestAttributes&&{requestAttributes:pt(e.requestAttributes)}),void 0!==e.sessionAttributes&&{sessionAttributes:pt(e.sessionAttributes)})),[4,t.endpoint()];case 1:return a=c.sent(),[2,new Qe.a({protocol:void 0===(s=a.protocol)?"https":s,hostname:a.hostname,port:a.port,method:"POST",headers:n,path:i,body:o})]}}))}))}(e,t)},t.prototype.deserialize=function(e,t){return function(e,t){return Object(Ee.b)(void 0,void 0,void 0,(function(){var n,i;return Object(Ee.e)(this,(function(r){switch(r.label){case 0:return 200!==e.statusCode&&e.statusCode>=400?[2,et(e,t)]:(n={$metadata:ht(e),__type:"PostTextResponse",dialogState:void 0,intentName:void 0,message:void 0,messageFormat:void 0,responseCard:void 0,sentimentResponse:void 0,sessionAttributes:void 0,sessionId:void 0,slotToElicit:void 0,slots:void 0},[4,gt(e.body,t)]);case 1:return null!=(i=r.sent()).dialogState&&(n.dialogState=i.dialogState),null!=i.intentName&&(n.intentName=i.intentName),null!=i.message&&(n.message=i.message),null!=i.messageFormat&&(n.messageFormat=i.messageFormat),null!=i.responseCard&&(n.responseCard=function(e,t){return{__type:"ResponseCard",contentType:null!=e.contentType?e.contentType:void 0,genericAttachments:null!=e.genericAttachments?ft(e.genericAttachments,t):void 0,version:null!=e.version?e.version:void 0}}(i.responseCard,t)),null!=i.sentimentResponse&&(n.sentimentResponse=function(e,t){return{__type:"SentimentResponse",sentimentLabel:null!=e.sentimentLabel?e.sentimentLabel:void 0,sentimentScore:null!=e.sentimentScore?e.sentimentScore:void 0}}(i.sentimentResponse)),null!=i.sessionAttributes&&(n.sessionAttributes=bt(i.sessionAttributes)),null!=i.sessionId&&(n.sessionId=i.sessionId),null!=i.slotToElicit&&(n.slotToElicit=i.slotToElicit),null!=i.slots&&(n.slots=bt(i.slots)),[2,Promise.resolve(n)]}}))}))}(e,t)},t}(Ye.b),Ot=function(e){function t(t){var n=e.call(this)||this;return n.input=t,n}return Object(Ee.d)(t,e),t.prototype.resolveMiddleware=function(e,t,n){this.middlewareStack.use(Object(xt.a)(t,this.serialize,this.deserialize));var i=e.concat(this.middlewareStack),r=t.requestHandler;return i.resolve((function(e){return r.handle(e.request,n||{})}),{logger:t.logger,inputFilterSensitiveLog:q.filterSensitiveLog,outputFilterSensitiveLog:V.filterSensitiveLog})},t.prototype.serialize=function(e,t){return function(e,t){return Object(Ee.b)(void 0,void 0,void 0,(function(){var n,i,r,o,a,s;return Object(Ee.e)(this,(function(c){switch(c.label){case 0:if(n=Object(Ee.a)(Object(Ee.a)(Object(Ee.a)(Object(Ee.a)({"Content-Type":"application/octet-stream","x-amz-content-sha256":"UNSIGNED-PAYLOAD"},vt(e.sessionAttributes)&&{"x-amz-lex-session-attributes":Ye.c.fromObject(e.sessionAttributes)}),vt(e.requestAttributes)&&{"x-amz-lex-request-attributes":Ye.c.fromObject(e.requestAttributes)}),vt(e.accept)&&{Accept:e.accept}),vt(e.contentType)&&{"Content-Type":e.contentType}),i="/bot/{botName}/alias/{botAlias}/user/{userId}/content",void 0===e.userId)throw new Error("No value provided for input HTTP label: userId.");if((r=e.userId).length<=0)throw new Error("Empty value provided for input HTTP label: userId.");if(i=i.replace("{userId}",Object(Ye.f)(r)),void 0===e.botName)throw new Error("No value provided for input HTTP label: botName.");if((r=e.botName).length<=0)throw new Error("Empty value provided for input HTTP label: botName.");if(i=i.replace("{botName}",Object(Ye.f)(r)),void 0===e.botAlias)throw new Error("No value provided for input HTTP label: botAlias.");if((r=e.botAlias).length<=0)throw new Error("Empty value provided for input HTTP label: botAlias.");return i=i.replace("{botAlias}",Object(Ye.f)(r)),void 0!==e.inputStream&&(o=e.inputStream),[4,t.endpoint()];case 1:return a=c.sent(),[2,new Qe.a({protocol:void 0===(s=a.protocol)?"https":s,hostname:a.hostname,port:a.port,method:"POST",headers:n,path:i,body:o})]}}))}))}(e,t)},t.prototype.deserialize=function(e,t){return function(e,t){return Object(Ee.b)(void 0,void 0,void 0,(function(){var n;return Object(Ee.e)(this,(function(i){return 200!==e.statusCode&&e.statusCode>=400?[2,Ze(e,t)]:(n={$metadata:ht(e),__type:"PostContentResponse",audioStream:void 0,contentType:void 0,dialogState:void 0,inputTranscript:void 0,intentName:void 0,message:void 0,messageFormat:void 0,sentimentResponse:void 0,sessionAttributes:void 0,sessionId:void 0,slotToElicit:void 0,slots:void 0},void 0!==e.headers["x-amz-lex-message"]&&(n.message=e.headers["x-amz-lex-message"]),void 0!==e.headers["x-amz-lex-slots"]&&(n.slots=new Ye.c(e.headers["x-amz-lex-slots"])),void 0!==e.headers["x-amz-lex-dialog-state"]&&(n.dialogState=e.headers["x-amz-lex-dialog-state"]),void 0!==e.headers["x-amz-lex-intent-name"]&&(n.intentName=e.headers["x-amz-lex-intent-name"]),void 0!==e.headers["x-amz-lex-input-transcript"]&&(n.inputTranscript=e.headers["x-amz-lex-input-transcript"]),void 0!==e.headers["x-amz-lex-message-format"]&&(n.messageFormat=e.headers["x-amz-lex-message-format"]),void 0!==e.headers["content-type"]&&(n.contentType=e.headers["content-type"]),void 0!==e.headers["x-amz-lex-session-id"]&&(n.sessionId=e.headers["x-amz-lex-session-id"]),void 0!==e.headers["x-amz-lex-session-attributes"]&&(n.sessionAttributes=new Ye.c(e.headers["x-amz-lex-session-attributes"])),void 0!==e.headers["x-amz-lex-sentiment"]&&(n.sentimentResponse=e.headers["x-amz-lex-sentiment"]),void 0!==e.headers["x-amz-lex-slot-to-elicit"]&&(n.slotToElicit=e.headers["x-amz-lex-slot-to-elicit"]),n.audioStream=e.body,[2,Promise.resolve(n)])}))}))}(e,t)},t}(Ye.b),jt=n("R10A"),St=n("+rSW"),Et=function(e){if(e instanceof Blob||e instanceof ReadableStream)return new Response(e).arrayBuffer().then((function(e){return new Uint8Array(e)}));throw new Error("Readable is not supported.")},Tt=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),kt=function(){return(kt=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},Ct=new he.a("AWSLexProvider"),At=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;return n._botsCompleteCallback={},n}return Tt(t,e),t.prototype.getProviderName=function(){return"AWSLexProvider"},t.prototype.reportBotStatus=function(e,t){var n=this;Ct.debug("postContent state",e.dialogState),"ReadyForFulfillment"!==e.dialogState&&"Fulfilled"!==e.dialogState||("function"==typeof this._botsCompleteCallback[t]&&setTimeout((function(){return n._botsCompleteCallback[t](null,{slots:e.slots})}),0),this._config&&"function"==typeof this._config[t].onComplete&&setTimeout((function(){return n._config[t].onComplete(null,{slots:e.slots})}),0)),"Failed"===e.dialogState&&("function"==typeof this._botsCompleteCallback[t]&&setTimeout((function(){return n._botsCompleteCallback[t]("Bot conversation failed")}),0),this._config&&"function"==typeof this._config[t].onComplete&&setTimeout((function(){return n._config[t].onComplete("Bot conversation failed")}),0))},t.prototype.sendMessage=function(e,t){return n=this,void 0,r=function(){var n,i,r,o,a,s,c,u,l;return function(e,t){var n,i,r,o,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,i&&(r=2&o[0]?i.return:o[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,o[1])).done)return r;switch(i=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,i=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!((r=(r=a.trys).length>0&&r[r.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){a.label=o[1];break}if(6===o[0]&&a.label<r[1]){a.label=r[1],r=o;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(o);break}r[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(s){o=[6,s],i=0}finally{n=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}(this,(function(d){switch(d.label){case 0:return this._config[e]?[4,jt.a.get()]:[2,Promise.reject("Bot "+e+" does not exist")];case 1:if(!(n=d.sent()))return[2,Promise.reject("No credentials")];if(this.lexRuntimeServiceClient=new Ke({region:this._config[e].region,credentials:n,customUserAgent:Object(St.b)()}),"string"!=typeof t)return[3,6];i={botAlias:this._config[e].alias,botName:e,inputText:t,userId:n.identityId},Ct.debug("postText to lex",t),d.label=2;case 2:return d.trys.push([2,4,,5]),r=new wt(i),[4,this.lexRuntimeServiceClient.send(r)];case 3:return c=d.sent(),this.reportBotStatus(c,e),[2,c];case 4:return o=d.sent(),[2,Promise.reject(o)];case 5:return[3,11];case 6:a=t.content,i="voice"===t.options.messageType?{botAlias:this._config[e].alias,botName:e,contentType:"audio/x-l16; sample-rate=16000",inputStream:a,userId:n.identityId,accept:"audio/mpeg"}:{botAlias:this._config[e].alias,botName:e,contentType:"text/plain; charset=utf-8",inputStream:a,userId:n.identityId,accept:"audio/mpeg"},Ct.debug("postContent to lex",t),d.label=7;case 7:return d.trys.push([7,10,,11]),s=new Ot(i),[4,this.lexRuntimeServiceClient.send(s)];case 8:return c=d.sent(),[4,Et(c.audioStream)];case 9:return u=d.sent(),this.reportBotStatus(c,e),[2,kt(kt({},c),{audioStream:u})];case 10:return l=d.sent(),[2,Promise.reject(l)];case 11:return[2]}}))},new((i=void 0)||(i=Promise))((function(e,t){function o(e){try{s(r.next(e))}catch(n){t(n)}}function a(e){try{s(r.throw(e))}catch(n){t(n)}}function s(t){var n;t.done?e(t.value):(n=t.value,n instanceof i?n:new i((function(e){e(n)}))).then(o,a)}s((r=r.apply(n,[])).next())}));var n,i,r},t.prototype.onComplete=function(e,t){if(!this._config[e])throw new ErrorEvent("Bot "+e+" does not exist");this._botsCompleteCallback[e]=t},t}(Se),Lt=function(){return(Lt=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},It=new he.a("Interactions"),Rt=new(function(){function e(e){this._options=e,It.debug("Interactions Options",this._options),this._pluggables={}}return e.prototype.getModuleName=function(){return"Interactions"},e.prototype.configure=function(e){var t=this,n=e?e.Interactions||e:{};It.debug("configure Interactions",{opt:n}),this._options=Lt(Lt({bots:{}},n),n.Interactions);var i=this._options.aws_bots_config,r=this._options.bots;return!Object.keys(r).length&&i&&Array.isArray(i)&&i.forEach((function(e){t._options.bots[e.name]=e})),!this._pluggables.AWSLexProvider&&r&&Object.keys(r).map((function(e){return r[e]})).find((function(e){return!e.providerName||"AWSLexProvider"===e.providerName}))&&(this._pluggables.AWSLexProvider=new At),Object.keys(this._pluggables).map((function(e){t._pluggables[e].configure(t._options.bots)})),this._options},e.prototype.addPluggable=function(e){if(e&&"Interactions"===e.getCategory()){if(this._pluggables[e.getProviderName()])throw new Error("Bot "+e.getProviderName()+" already plugged");return e.configure(this._options.bots),void(this._pluggables[e.getProviderName()]=e)}},e.prototype.send=function(e,t){return n=this,void 0,r=function(){var n;return function(e,t){var n,i,r,o,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,i&&(r=2&o[0]?i.return:o[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,o[1])).done)return r;switch(i=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,i=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!((r=(r=a.trys).length>0&&r[r.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){a.label=o[1];break}if(6===o[0]&&a.label<r[1]){a.label=r[1],r=o;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(o);break}r[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(s){o=[6,s],i=0}finally{n=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}(this,(function(i){switch(i.label){case 0:if(!this._options.bots||!this._options.bots[e])throw new Error("Bot "+e+" does not exist");if(!this._pluggables[n=this._options.bots[e].providerName||"AWSLexProvider"])throw new Error("Bot "+n+" does not have valid pluggin did you try addPluggable first?");return[4,this._pluggables[n].sendMessage(e,t)];case 1:return[2,i.sent()]}}))},new((i=void 0)||(i=Promise))((function(e,t){function o(e){try{s(r.next(e))}catch(n){t(n)}}function a(e){try{s(r.throw(e))}catch(n){t(n)}}function s(t){var n;t.done?e(t.value):(n=t.value,n instanceof i?n:new i((function(e){e(n)}))).then(o,a)}s((r=r.apply(n,[])).next())}));var n,i,r},e.prototype.onComplete=function(e,t){if(!this._options.bots||!this._options.bots[e])throw new Error("Bot "+e+" does not exist");var n=this._options.bots[e].providerName||"AWSLexProvider";if(!this._pluggables[n])throw new Error("Bot "+n+" does not have valid pluggin did you try addPluggable first?");this._pluggables[n].onComplete(e,t)},e}())(null);we.a.register(Rt);var _t,Nt,Pt,zt=function(e,t,n){for(var i=0;i<n.length;i++)e.setUint8(t+i,n.charCodeAt(i))},Ft=function(e,t,n,i){var r=function(e,t){var n=2*e.length,i=8+n,r=new ArrayBuffer(36+i),o=new DataView(r);return zt(o,0,"RIFF"),o.setUint32(4,24+i,!0),zt(o,8,"WAVE"),zt(o,12,"fmt "),o.setUint32(16,16,!0),o.setUint16(20,1,!0),o.setUint16(22,1,!0),o.setUint32(24,t,!0),o.setUint32(28,2*t,!0),o.setUint16(32,2,!0),o.setUint16(34,16,!0),zt(o,36,"data"),o.setUint32(40,n,!0),function(e,t,n){for(var i=44,r=0;r<n.length;r++,i+=2){var o=Math.max(-1,Math.min(1,n[r]));e.setInt16(i,o<0?32768*o:32767*o,!0)}}(o,0,e),o}(function(e,t,n){if(n===t)return e;for(var i=t/n,r=Math.round(e.length/i),o=new Float32Array(r),a=0,s=0;a<o.length;){for(var c=Math.round((a+1)*i),u=0,l=0,d=s;d<c&&d<e.length;d++)u+=e[d],l++;o[a]=u/l,a++,s=c}return o}(function(e,t){for(var n=new Float32Array(t),i=0,r=0;r<e.length;r++)n.set(e[r],i),i+=e[r].length;return n}(e,t),n,i),i);return new Blob([r],{type:"application/octet-stream"})},Bt=new he.a("AudioRecorder"),Mt=function(){function e(t){Object(fe.a)(this,e),this.streamBuffer=[],this.streamBufferLength=0,this.recording=!1,this.options=t}var t,n,i,r;return Object(me.a)(e,[{key:"init",value:(r=Object(pe.a)(de.a.mark((function e(){var t=this;return de.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!Object(ve.b)().isBrowser){e.next=7;break}return window.AudioContext=window.AudioContext||window.webkitAudioContext,this.audioContext=new AudioContext,e.next=5,navigator.mediaDevices.getUserMedia({audio:!0}).then((function(e){t.audioSupported=!0,t.setupAudioNodes(e)})).catch((function(){return t.audioSupported=!1,Promise.reject("Audio is not supported")}));case 5:e.next=9;break;case 7:return this.audioSupported=!1,e.abrupt("return",Promise.reject("Audio is not supported"));case 9:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"setupAudioNodes",value:(i=Object(pe.a)(de.a.mark((function e(t){var n,i,r,o=this;return de.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.audioContext.resume();case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),Bt.error(e.t0);case 8:n=this.audioContext.createMediaStreamSource(t),(i=this.audioContext.createScriptProcessor(4096,1,1)).onaudioprocess=function(e){if(o.recording){var t=e.inputBuffer.getChannelData(0);o.streamBuffer.push(new Float32Array(t)),o.streamBufferLength+=t.length,o.analyse()}},(r=this.audioContext.createAnalyser()).minDecibels=-90,r.maxDecibels=-10,r.smoothingTimeConstant=.85,n.connect(r),r.connect(i),i.connect(n.context.destination),this.analyserNode=r;case 19:case"end":return e.stop()}}),e,this,[[0,5]])}))),function(e){return i.apply(this,arguments)})},{key:"startRecording",value:(n=Object(pe.a)(de.a.mark((function e(t,n){var i;return de.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.recording&&this.audioSupported){e.next=2;break}return e.abrupt("return");case 2:return this.onSilence=t||function(){},this.visualizer=n||function(){},i=this.audioContext,e.prev=5,e.next=8,i.resume();case 8:e.next=13;break;case 10:e.prev=10,e.t0=e.catch(5),Bt.error(e.t0);case 13:this.start=Date.now(),this.recording=!0;case 15:case"end":return e.stop()}}),e,this,[[5,10]])}))),function(e,t){return n.apply(this,arguments)})},{key:"stopRecording",value:function(){this.audioSupported&&(this.recording=!1)}},{key:"clear",value:function(){this.stopRecording(),this.streamBufferLength=0,this.streamBuffer=[]}},{key:"play",value:function(e){var t=this;if(e&&this.audioSupported){var n=new Blob([e]);return new Promise((function(e,i){var r=new FileReader;r.onload=function(){t.playbackSource&&t.playbackSource.disconnect(),t.playbackSource=t.audioContext.createBufferSource(),t.audioContext.decodeAudioData(r.result,(function(n){t.playbackSource.buffer=n,t.playbackSource.connect(t.audioContext.destination),t.playbackSource.onended=function(){return e()},t.playbackSource.start(0)}),(function(e){return i(e)}))},r.onerror=function(){return i()},r.readAsArrayBuffer(n)}))}}},{key:"stop",value:function(){this.playbackSource&&this.playbackSource.stop()}},{key:"analyse",value:function(){if(this.audioSupported){var e=this.analyserNode;e.fftSize=2048;var t=e.fftSize,n=new Uint8Array(t),i=this.options.amplitude,r=this.options.time;e.getByteTimeDomainData(n),this.visualizer(n,t);for(var o=0;o<t;o++){var a=n[o]/128-1;(a>i||a<-1*i)&&(this.start=Date.now())}Date.now()-this.start>r&&this.onSilence()}}},{key:"exportWAV",value:(t=Object(pe.a)(de.a.mark((function e(){var t,n,i=arguments;return de.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=i.length>0&&void 0!==i[0]?i[0]:16e3,this.audioSupported){e.next=3;break}return e.abrupt("return");case 3:return n=Ft(this.streamBuffer,this.streamBufferLength,this.audioContext.sampleRate,t),this.clear(),e.abrupt("return",n);case 7:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),e}();!function(e){e[e.Initial=0]="Initial",e[e.Listening=1]="Listening",e[e.SendingText=2]="SendingText",e[e.SendingVoice=3]="SendingVoice",e[e.Error=4]="Error"}(_t||(_t={})),function(e){e.Bot="bot",e.User="user"}(Nt||(Nt={})),function(e){e[e.Recoverable=0]="Recoverable",e[e.Unrecoverable=1]="Unrecoverable"}(Pt||(Pt={}));var Ut=function(){function e(t){var n=this;Object(fe.a)(this,e),Object(be.k)(this,t),this.clearOnComplete=!1,this.conversationModeOn=!1,this.botTitle=ye.a.CHATBOT_TITLE,this.voiceEnabled=!1,this.textEnabled=!0,this.silenceTime=1500,this.silenceThreshold=.2,this.messages=[],this.text="",this.chatState=_t.Initial,this.messageJSX=function(e){var t=e.map((function(e){return Object(be.i)("div",{class:"bubble ".concat(e.from)},e.content)}));if(n.chatState===_t.SendingText||n.chatState===_t.SendingVoice){var i=n.chatState===_t.SendingText?Nt.Bot:Nt.User;t.push(Object(be.i)("div",{class:"bubble ".concat(i)},Object(be.i)("div",{class:"dot-flashing ".concat(i)},Object(be.i)("span",{class:"dot left"}),Object(be.i)("span",{class:"dot middle"}),Object(be.i)("span",{class:"dot right"}))))}return t},this.chatCompleted=Object(be.f)(this,"chatCompleted",7)}var t,n;return Object(me.a)(e,[{key:"submitHandler",value:function(e){this.sendTextMessage()}},{key:"componentWillLoad",value:function(){if(!Rt||"function"!=typeof Rt.onComplete)throw new Error(xe.m);this.validateProps()}},{key:"componentDidRender",value:function(){var e=this.element.shadowRoot.querySelector(".body");e.scrollTop=e.scrollHeight}},{key:"validateProps",value:function(){var e=this;if(this.voiceEnabled||this.textEnabled)if(this.botName){this.welcomeMessage&&this.appendToChat(this.welcomeMessage,Nt.Bot),this.voiceEnabled&&(this.audioRecorder=new Mt({time:this.silenceTime,amplitude:this.silenceThreshold}),this.audioRecorder.init().catch((function(t){e.setError(t,Pt.Recoverable)})));try{Rt.onComplete(this.botName,(function(t,n){e.chatCompleted.emit({data:n,err:t}),e.clearOnComplete?e.reset():e.chatState=_t.Initial}))}catch(t){this.setError(t,Pt.Unrecoverable)}}else this.setError(ye.a.NO_BOT_NAME_ERROR,Pt.Unrecoverable);else this.setError(ye.a.CHAT_DISABLED_ERROR,Pt.Unrecoverable)}},{key:"handleMicButton",value:function(){var e=this;this.chatState===_t.Initial&&(this.audioRecorder.stop(),this.chatState=_t.Listening,this.audioRecorder.startRecording((function(){return e.handleSilence()}),(function(t,n){return e.visualizer(t,n)})))}},{key:"handleSilence",value:function(){var e=this;this.chatState=_t.SendingVoice,this.audioRecorder.stopRecording(),this.audioRecorder.exportWAV().then((function(t){e.sendVoiceMessage(t)}))}},{key:"handleTextChange",value:function(e){this.text=e.target.value}},{key:"handleCancelButton",value:function(){this.audioRecorder.clear(),this.chatState=_t.Initial}},{key:"handleToastClose",value:function(e){this.error=void 0,e===Pt.Recoverable&&(this.chatState=_t.Initial)}},{key:"visualizer",value:function(e,t){!function(e,t,n){if(n){if(!Object(ve.b)().isBrowser)throw new Error("Visualization is not supported on non-browsers.");var i=n.getBoundingClientRect(),r=i.width,o=i.height;n.width=r,n.height=o;var a=n.getContext("2d");a.fillStyle="white",a.clearRect(0,0,r,o),requestAnimationFrame((function(){a.fillRect(0,0,r,o),a.lineWidth=1;var i=getComputedStyle(document.documentElement).getPropertyValue("--amplify-primary-color");a.strokeStyle=i&&""!==i?i:"#ff9900",a.beginPath();for(var s=1*r/t,c=0,u=0;u<t||u%3==0;u++){var l=e[u]/128*o/2;0===u?a.moveTo(c,l):a.lineTo(c,l),c+=s}a.lineTo(n.width,n.height/2),a.stroke()}))}}(e,t,this.element.shadowRoot.querySelector("canvas"))}},{key:"sendTextMessage",value:(n=Object(pe.a)(de.a.mark((function e(){var t,n;return de.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==this.text.length&&this.chatState===_t.Initial){e.next=2;break}return e.abrupt("return");case 2:return t=this.text,this.text="",this.appendToChat(t,Nt.User),this.chatState=_t.SendingText,e.prev=6,e.next=9,Rt.send(this.botName,t);case 9:n=e.sent,e.next=16;break;case 12:return e.prev=12,e.t0=e.catch(6),this.setError(e.t0,Pt.Recoverable),e.abrupt("return");case 16:n.message&&this.appendToChat(n.message,Nt.Bot),this.chatState=_t.Initial;case 18:case"end":return e.stop()}}),e,this,[[6,12]])}))),function(){return n.apply(this,arguments)})},{key:"sendVoiceMessage",value:(t=Object(pe.a)(de.a.mark((function e(t){var n,i,r,o=this;return de.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={content:t,options:{messageType:"voice"}},e.prev=1,e.next=4,Rt.send(this.botName,n);case 4:i=e.sent,e.next=11;break;case 7:return e.prev=7,e.t0=e.catch(1),this.setError(e.t0,Pt.Recoverable),e.abrupt("return");case 11:return this.chatState=_t.Initial,r=i.dialogState,i.inputTranscript&&this.appendToChat(i.inputTranscript,Nt.User),this.appendToChat(i.message,Nt.Bot),e.next=17,this.audioRecorder.play(i.audioStream).then((function(){o.conversationModeOn&&"Fulfilled"!==r&&"Failed"!==r&&o.chatState===_t.Initial&&o.handleMicButton()})).catch((function(e){return o.setError(e,Pt.Recoverable)}));case 17:case"end":return e.stop()}}),e,this,[[1,7]])}))),function(e){return t.apply(this,arguments)})},{key:"appendToChat",value:function(e,t){this.messages=[].concat(Object(ue.a)(this.messages),[{content:e,from:t}])}},{key:"setError",value:function(e,t){var n="string"==typeof e?e:e.message;this.chatState=_t.Error,this.error={message:n,errorType:t}}},{key:"reset",value:function(){this.chatState=_t.Initial,this.text="",this.error=void 0,this.messages=[],this.welcomeMessage&&this.appendToChat(this.welcomeMessage,Nt.Bot),this.audioRecorder&&this.audioRecorder.clear()}},{key:"listeningFooterJSX",value:function(){var e=this;return[Object(be.i)("canvas",{height:"50"}),Object(be.i)("amplify-button",{"data-test":"chatbot-cancel-button",handleButtonClick:function(){return e.handleCancelButton()},class:"icon-button",variant:"icon",icon:"ban"})]}},{key:"footerJSX",value:function(){var e=this;if(this.chatState===_t.Listening)return this.listeningFooterJSX();var t=this.textEnabled?ye.a.TEXT_INPUT_PLACEHOLDER:ye.a.VOICE_INPUT_PLACEHOLDER;return[Object(be.i)("amplify-input",{placeholder:ge.a.get(t),description:"text",handleInputChange:function(t){return e.handleTextChange(t)},value:this.text,disabled:this.chatState===_t.Error||!this.textEnabled}),this.voiceEnabled&&Object(be.i)("amplify-button",{"data-test":"chatbot-mic-button",handleButtonClick:function(){return e.handleMicButton()},class:"icon-button",variant:"icon",icon:"microphone",disabled:this.chatState===_t.Error||this.chatState!==_t.Initial}),this.textEnabled&&Object(be.i)("amplify-button",{"data-test":"chatbot-send-button",class:"icon-button",variant:"icon",icon:"send",handleButtonClick:function(){return e.sendTextMessage()},disabled:this.chatState===_t.Error||this.chatState!==_t.Initial})]}},{key:"errorToast",value:function(){var e=this;if(this.error){var t=this.error,n=t.message,i=t.errorType;return Object(be.i)("amplify-toast",{message:ge.a.get(n),handleClose:function(){return e.handleToastClose(i)}})}}},{key:"render",value:function(){return Object(be.i)(be.b,null,Object(be.i)("div",{class:"amplify-chatbot"},Object(be.i)("slot",{name:"header"},Object(be.i)("div",{class:"header","data-test":"chatbot-header"},ge.a.get(this.botTitle))),Object(be.i)("div",{class:"body","data-test":"chatbot-body"},this.messageJSX(this.messages)),Object(be.i)("div",{class:"footer","data-test":"chatbot-footer"},this.footerJSX()),this.errorToast()))}},{key:"element",get:function(){return Object(be.h)(this)}}]),e}();Ut.style=".bot .dot{background-color:var(--bot-dot-color)}.user .dot{background-color:var(--user-dot-color)}.dot-flashing{width:2.625rem}.dot-flashing .dot{display:inline-block;width:0.625rem;height:0.625rem;border-radius:10rem;opacity:0.65}.dot-flashing .left{-webkit-animation:dot-flashing 1s infinite alternate;animation:dot-flashing 1s infinite alternate;-webkit-animation-delay:0s;animation-delay:0s}.dot-flashing .middle{margin-left:0.375rem;margin-right:0.375rem;-webkit-animation:dot-flashing 1s infinite linear alternate;animation:dot-flashing 1s infinite linear alternate;-webkit-animation-delay:0.5s;animation-delay:0.5s}.dot-flashing .right{-webkit-animation:dot-flashing 1s infinite alternate;animation:dot-flashing 1s infinite alternate;-webkit-animation-delay:1s;animation-delay:1s}@-webkit-keyframes dot-flashing{0%{opacity:0.65}50%,100%{opacity:0.1}}@keyframes dot-flashing{0%{opacity:0.65}50%,100%{opacity:0.1}}:host{--width:28.75rem;--height:37.5rem;--header-color:var(--amplify-secondary-color);--header-size:var(--amplify-text-lg);--bot-background-color:rgb(230, 230, 230);--bot-text-color:black;--bot-dot-color:var(--bot-text-color);--user-background-color:var(--amplify-blue);--user-text-color:var(--amplify-white);--user-dot-color:var(--user-text-color)}.amplify-chatbot{display:-ms-inline-flexbox;display:inline-flex;-ms-flex-direction:column;flex-direction:column;background-color:var(--background-color);border-radius:0.375rem;-webkit-box-shadow:0.0625rem 0rem 0.25rem 0 rgba(0, 0, 0, 0.15);box-shadow:0.0625rem 0rem 0.25rem 0 rgba(0, 0, 0, 0.15);-webkit-box-sizing:border-box;box-sizing:border-box;font-family:var(--amplify-font-family);margin-bottom:1rem;width:100%;height:var(--height);max-width:var(--width)}@media (min-width: 672px){.amplify-chatbot{width:var(--width)}}.header{padding:1.25rem 0.375rem 1.25rem 0.375rem;color:var(--header-color);font-size:var(--header-size);font-weight:bold;text-align:center;word-wrap:break-word}.body{border-top:0.0625rem solid rgba(0, 0, 0, 0.05);padding:1.5rem 1rem 0 1rem;display:-ms-flexbox;display:flex;-ms-flex-positive:1;flex-grow:1;-ms-flex-direction:column;flex-direction:column;overflow:auto}.bubble{max-width:100%;padding:0.8em 1.4em;text-align:left;word-wrap:break-word;margin-bottom:0.625rem}.bot{margin-right:auto;background-color:var(--bot-background-color);color:var(--bot-text-color);border-radius:1.5rem 1.5rem 1.5rem 0}.user{margin-left:auto;background-color:var(--user-background-color);color:var(--user-text-color);border-radius:1.5rem 1.5rem 0 1.5rem}.footer{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;border-top:0.062rem solid rgba(0, 0, 0, 0.05);padding-right:0.625rem;min-height:3.125rem}.footer amplify-input{--border:none;--margin:0;-ms-flex-positive:1;flex-grow:1}canvas{margin-left:0.625rem;margin-right:0.625rem;-ms-flex-positive:1;flex-grow:1;height:3.125rem}.icon-button{--icon-height:1.25rem;--icon-fill:var(--amplify-primary-color);--padding:0.625rem;--width:auto}"}}]);